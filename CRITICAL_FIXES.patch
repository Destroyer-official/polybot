# CRITICAL FIXES TO APPLY MANUALLY

## Fix 1: Change min_consensus from 60.0 to 15.0
File: src/fifteen_min_crypto_strategy.py
Line: ~349

FIND:
            min_consensus=60.0  # Require 60% consensus for execution

REPLACE WITH:
            min_consensus=15.0  # Lowered to 15% to allow more trades

## Fix 2: Add missing _check_circuit_breaker method
File: src/fifteen_min_crypto_strategy.py
Location: After _should_take_trade method (around line 868)

ADD THIS METHOD:

    def _check_circuit_breaker(self) -> bool:
        """
        Check if circuit breaker is active (too many consecutive losses).
        
        Returns:
            True if trading is allowed, False if circuit breaker is active
        """
        # Check consecutive losses
        max_consecutive_losses = 5
        recent_trades = list(self.stats.get('recent_outcomes', []))[-max_consecutive_losses:]
        
        if len(recent_trades) >= max_consecutive_losses:
            if all(outcome == 'loss' for outcome in recent_trades):
                logger.warning(f"ðŸ”´ CIRCUIT BREAKER: {max_consecutive_losses} consecutive losses")
                return False
        
        return True

## Fix 3: Add missing _check_daily_loss_limit method
File: src/fifteen_min_crypto_strategy.py
Location: After _check_circuit_breaker method

ADD THIS METHOD:

    def _check_daily_loss_limit(self) -> bool:
        """
        Check if daily loss limit has been reached.
        
        Returns:
            True if trading is allowed, False if daily loss limit reached
        """
        daily_pnl = self.stats.get('total_profit', Decimal('0'))
        max_daily_loss = Decimal('-10.0')  # Stop trading if down $10 in a day
        
        if daily_pnl < max_daily_loss:
            logger.warning(f"ðŸ”´ DAILY LOSS LIMIT: ${daily_pnl:.2f} < ${max_daily_loss:.2f}")
            return False
        
        return True

## Fix 4: Update log message
File: src/fifteen_min_crypto_strategy.py
Line: ~1338

FIND:
                logger.info(f"   Consensus: {ensemble_decision.consensus_score:.1f}% (need >= 50%)")

REPLACE WITH:
                logger.info(f"   Consensus: {ensemble_decision.consensus_score:.1f}% (need >= 15%)")

## Fix 5: Already done - async/await in main_orchestrator.py
File: src/main_orchestrator.py
Line: ~1095
Status: âœ… ALREADY FIXED

## Fix 6: Already done - detailed logging in ensemble_decision_engine.py
File: src/ensemble_decision_engine.py
Status: âœ… ALREADY FIXED
